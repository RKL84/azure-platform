  parameters:
  - name: environment
    type: string
  - name: workloadName
    type: string
  - name: deploymentName
    type: string

  jobs:
  - template: /.azuredevops/pipeline-templates/jobs.deployInfra.yml
    parameters:
      workloadName: ${{ parameters.workloadName }}
      environment: ${{ parameters.environment }}
      templateFilePath: $(Pipeline.Workspace)/$(artifactName)/main.bicep
      templateParameterFilePath: $(Build.SourcesDirectory)/deploy/parameters.${{ parameters.environment }}.json
      deploymentName: ${{ parameters.deploymentName }}

  # - template: /.azuredevops/pipeline-templates/jobs.deployFunctionApp.yml
  #   parameters:
  #     appName: func-${{ parameters.appName }}-${{ parameters.environment }}
  #     package: '$(Pipeline.Workspace)/FunctionApp/$(buildConfiguration)/*.zip'
